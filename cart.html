<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anek+Latin:wght@100..800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Give+You+Glory&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/css/main-2b73ac9e.css" />
    <link rel="icon" type="image/x-icon" href="/assets/images/favicon.png">
    <script src="/assets/js/main-eff4185c.js"></script>
    <script src="https://js.stripe.com/v3"></script>
    <title>Izzy Sempill</title>

    <style>

        #page-container {
            display: grid;
            grid-template-rows: auto 1fr auto;
        }

        #main-content .main-content-body[data-has-items="false"] .cart-wrapper {
            display: none;
        }

        #main-content .main-content-body[data-has-items="true"] .empty-message {
            display: none;
        }

        #main-content .main-content-body .empty-message {
            text-align: center;
            font-size: 20px;
        }

        #main-content .main-content-body .empty-message span {
            display: block;
        }

        #main-content .main-content-body .empty-message span:last-child {
            color: var(--theme-green);
            cursor: pointer;
            margin-top: 20px;
            font-size: 24px;
        }

        #main-content .main-content-body .cart-wrapper {
            display: flex;
            flex-wrap: wrap;
            width: 100%;
            gap: 30px;
        }

        #main-content .main-content-body .cart-wrapper .cart-flex-item {
            flex: 1 1 500px;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper {
            display: grid;
            gap: 10px;
            grid-template-columns: auto 1fr;
            grid-template-rows: auto auto 1fr;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-image {
            grid-row: span 3;
            height: 225px;
            background: var(--theme-blue);
            padding: 5px;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-image img {
            height: 100%;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-details {
            display: flex;
            justify-content: space-between;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-title {
			border-bottom: 1px solid rgba(0, 0, 0, 0.15);
    		padding-bottom: 10px;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-title .title {
            display: block;
			font-size: 20px;
            font-weight: bold;
        }

		#main-content .main-content-body .cart-wrapper .product-wrapper .product-title .subtitle {
            font-size: 14px;
            font-weight: normal;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-title .price {
            font-size: 14px;
			align-self: center;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-totals .quantity-wrapper .amount {
            margin: 0 5px;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-totals .total {
            font-size: 20px;
            font-weight: bold;
        }

        #main-content .main-content-body .cart-wrapper .product-wrapper .product-actions .remove {
            color: #e31919;
            cursor: pointer;
        }

        #main-content .main-content-body .cart-wrapper .payment-wrapper {
            font-size: 16px;
        }

        #main-content .main-content-body .cart-wrapper .payment-wrapper .total-wrapper {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 10px;
            font-size: 24px;
        }

        #main-content .main-content-body .cart-wrapper .payment-wrapper .checkout-message {

            background: var(--theme-blue);
            padding: 15px;
            border-radius: 5px;
            border: 1px solid var(--theme-blue-border);
            margin-bottom: 10px;

            font-size: 14px;
            text-align: center;
        }

        /* Buy Option */
        .checkout-button {
            width: 100%;
            height: 50px;
            background: var(--theme-green);
            border-radius: 8px;
            color: white;
            font-size: 14pt;
            font-weight: 500;
            letter-spacing: 1px;
            opacity: 0.95;
            box-shadow: rgba(0, 0, 0, 0.06) 0px 1px 3px, rgba(0, 0, 0, 0.12) 0px 1px 2px;

            padding: 0;
            font: inherit;
            cursor: pointer;
            outline: none;
            border: none;
        }

        .checkout-button.loading span.default {
            display: none;
        }
        
        .checkout-button:not(.loading) span.loading {
            display: none;
        }

        .checkout-button:active {
            opacity: 1;
            transform: translateY(1px);
        }

    </style>

</head>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N0HJ9SJ581"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-N0HJ9SJ581');
</script>

<body>
    
    <!-- Side Bar -->
    <div id="sidebar-shield">

    <!-- Side Bar -->
    <div id="sidebar">

        <div class="sidebar-header">
            <span class="close-icon" onclick="closeSidebar()">
                <img src="/assets/icons/close.svg" height="24">
            </span>
            <span class="logo logo-font">
                Izzy Sempill
            </span>
        </div>

        <div class="sidebar-content">

            <div class="sidebar-items">

                <div class="nav-layout">
                    <ul>
                        <li><a href="/">About</a></li>
                        <li><a href="/updates">Updates</a></li>
                        <li><a href="/printshop">Print Shop</a></li>
                        <li><a href="/cart">My Cart</a></li>
                    </ul>
                </div>

            </div>

        </div>

    </div>

</div>

    <!-- Page Content -->
    <div id="page-container">

        <!-- Top Bar -->
        <div id="topbar">

    <!-- Standard Content -->
    <div class="content-wrapper non-mobile">

        <span class="logo logo-font" onclick="window.location=window.location.origin">
            Izzy Sempill
        </span>
    
        <div class="nav-layout">
            <ul>
                <li><a href="/">About</a></li>
                <li><a href="/updates">Updates</a></li>
                <li><a href="/printshop">Print Shop</a></li>
                <li><a href="/cart"> <img src="/assets/icons/cart.svg"></a></li>
            </ul>
        </div>

    </div>


    <!-- Standard Content -->
    <div class="content-wrapper mobile-only">
        <div class="mobile-options">
            <span class="burger-menu" onclick="openSidebar()">
                <img src="/assets/icons/burger-menu.svg" height="24">
            </span>
            <span class="logo logo-font" onclick="window.location=window.location.origin">
                Izzy Sempill
            </span>    
        </div>
    </div>


</div>

        <!-- Main Content -->
        <div id="main-content" class="home-page">
            
            <!-- Page Subheading -->
            <div class="main-content-subheading">
                <span class="text-block-subheading">Your Cart</span>
            </div>

            <!-- Main Content -->
            <div class="main-content-body">

                <div id="cart-wrapper" class="cart-wrapper">

                    <div id="products-wrapper" class="products-wrapper cart-flex-item">

                        <!-- Product Template -->
                        <template id="product-template">
                            <div class="template-value-product-id">
                                <div class="product-wrapper">  
                                    <!-- Image -->
                                    <div class="product-image">
                                        <img class="template-value-img-src">
                                    </div>
                                    <!-- Title and Price -->
                                    <div class="product-title product-details">
										<div>
											<span class="title template-value-title"></span>
											<span class="subtitle template-value-subtitle"></span>
										</div>
                                        <span class="price template-value-price"></span>
                                    </div>
                                    <!-- Quantity and Total -->
                                    <div class="product-totals product-details">
                                        <div class="quantity-wrapper">
                                            <span class="message">Quantity:</span>
                                            <select class="amount template-value-quantity template-value-id" onchange="updateQuantity(this)" >
                                            </select>
                                        </div>
                                        <span class="total template-value-total"></span>
                                    </div>
                                    <!-- Remove Action -->
                                    <div class="product-actions product-details">
                                        <span class="remove template-value-id" onclick="removeItem(this)">Remove</span>
                                    </div>
                                </div>
                                <div class="divider"></div>
                            </div>
                        </template>

                    </div>

                     <!-- Product Details -->
                    <div class="payment-wrapper cart-flex-item">
                        <div class="total-wrapper">
                            <span class="message">Total</span>
                            <span class="total grant-total-value"></span>
                        </div>
                        <div class="checkout-message">
                            <span>Use the Secure Checkout button below. You will be redirected to a secure payment page to complete this purchase</span>
                        </div>
                        <button class="checkout-button" onclick="secureCheckout(this)">
                            <span class="default">Secure Checkout</span>
                            <span class="loading"><img src="/assets/icons/loading.svg"></span>
                        </button>

                    </div>

                </div>

                <div class="empty-message">
                    <span>Your cart is currently empty</span>
                    <span onclick="window.location='/printshop'">Visit Print Shop</span>
                </div>


            </div>

        </div>

        <!-- Footer -->
        <div id="footer">

    <div class="content-wrapper">

        <span class="logo logo-font logo-font-white">Izzy Sempill</span>
        <div class="nav nav-layout">
            <ul>
                <li><a href="/">About</a></li>
                <li><a href="/updates">Updates</a></li>
                <li><a href="/printshop">Print Shop</a></li>
                <li><a href="/contact">Contact</a></li>
            </ul>
            <span style="display: block; margin-top: 20px;">&copy; 2025 Izzy Sempill</span>
        </div>

    </div>

</div>

        </div>

    </div>

    <script>


        function secureCheckout(btnEl) {

            //cant add if "loading"
            if(btnEl.classList.contains('loading')) return;

            btnEl.classList.add('loading');
            goToStripeCheckout();

        }

        /*
         *
         */
        function updateQuantity(btnEl) {

            //update the item quantity in the cart
            let cartItem = updateItemQuantity(btnEl.dataset.stripeId, btnEl.value)
            let domEle = document.querySelector('[data-sid='+btnEl.dataset.stripeId+']')

            //update the DOM with the new product values
            setLocalProductValues(cartItem, domEle)

            //Update Grand Totals
            updateTotals();
            updateDisplay();

        }

        /*
         *
         */
        function removeItem(btnEl) {

            // remove the item from the cart
            removeProductFromCart(btnEl.dataset.stripeId)

            //get the correct DOM element, and remove it
            let domEle = document.querySelector('[data-sid='+btnEl.dataset.stripeId+']')
            domEle.remove();

            //Update Grand Totals
            updateTotals();
            updateDisplay();

        }

        /*
         *
         */
        function updateTotals() {

            let grandTotalValue = 0;
            let currentCart = getCurrentCart();

            for(let i = 0; i<currentCart.items.length; i++) {

                //get the item stored in the cart
                let cartItem = currentCart.items[i];
                let localProductItem = ALL_PRODUCTS[cartItem.price]; //"price" is the stripe ID
                let localProductTotal = (localProductItem.price * cartItem.quantity);

                //update the grand total value
                grandTotalValue += localProductTotal

            }

            //update the Grand Total
            document.querySelector('.grant-total-value').innerText = '£' + grandTotalValue;

        }

        /*
         *
         */
        function setLocalProductValues(cartItem, productElem) {

            //get the "local product" values
            let localProductItem = ALL_PRODUCTS[cartItem.price]; //"price" is the stripe ID
            let localProductName = localProductItem.name;
            let localVariantName = localProductItem.variantName;
            let localProductPrice = localProductItem.price;
            let localProductTotal = (localProductPrice * cartItem.quantity);
            let localProductImageSrc = localProductItem.imageSrc

            //set the relevant values
            //productElem.querySelector('.template-value-product-id').setAttribute('data-sid', cartItem.price);
            productElem.querySelector('.template-value-title').innerText = localProductName;
            productElem.querySelector('.template-value-subtitle').innerText = localVariantName;
            productElem.querySelector('.template-value-price').innerText = '£' + localProductPrice;
            productElem.querySelector('.template-value-quantity').value = cartItem.quantity;
            productElem.querySelector('.template-value-total').innerText = '£' + localProductTotal;
            productElem.querySelector('.template-value-img-src').src = localProductImageSrc;
            productElem.querySelectorAll('.template-value-id').forEach(el => el.dataset.stripeId = cartItem.price)

        }

        /*
         *
         */
        function updateDisplay() {
            let currentCart = getCurrentCart();
            let contentBody = document.querySelector('.main-content-body');
            contentBody.setAttribute('data-has-items', currentCart.items.length > 0);
        }


        (function() {
            
            cleanCart();

            let currentCart = getCurrentCart();

            for(let i = 0; i<currentCart.items.length; i++) {

                //get the item stored in the cart
                let cartItem = currentCart.items[i];

                // create a product card from the template
                let template = document.getElementById("product-template");
                let clone = template.content.cloneNode(true);

				// add the QTY select options
				let qtySelect = clone.querySelector('.template-value-quantity');
				for (var so = 1; so <= parseInt(cartItem.maxQuantity); so++){
					var opt = document.createElement('option');
					opt.value = so;
					opt.innerHTML = so;
					qtySelect.appendChild(opt);
				}

                //set all the values on the cloned object
                setLocalProductValues(cartItem, clone)
                clone.querySelector('.template-value-product-id').setAttribute('data-sid', cartItem.price);

                //add the product to the page
                document.getElementById('products-wrapper').appendChild(clone);
            }

            updateTotals();
            updateDisplay();
           
        })();

    </script>

</body>

</html>